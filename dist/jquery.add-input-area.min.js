/**
 * @file jquery.add-input-area
 * @version 4.9.3
 * @author Yuusaku Miyazaki <toumin.m7@gmail.com>
 * @license MIT
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?t(require("jquery"),window,document):t(jQuery,window,document)}(function(o,t,n,e){o.fn.addInputArea=function(t){return this.each(function(){new o.addInputArea(this,t)})},o.addInputArea=function(t,e){this.elem=t,this.option=this._setOption(e,o(this.elem).attr("id")),this._setDelBtnVisibility();var i=this;o(n).on("click",this.option.btn_add,function(){i._ehAddBtn.call(i)}),o(i.elem).on("click",i.option.btn_del,function(t){i._ehDelBtn.call(i,t)}),this._renumberFieldAll(),this.option.original=o(this.elem).find(this.option.area_var).eq(0).clone(this.option.clone_event)},o.extend(o.addInputArea.prototype,{_setOption:function(t,e){return(t=o.extend({btn_del:e?"."+e+"_del":".aia_del",btn_add:e?"."+e+"_add":".aia_add",area_var:e?"."+e+"_var":".aia_var",area_del:null,after_add:null,clone_event:!0,maximum:0},t)).area_del||(t.area_del=t.btn_del),t},_setDelBtnVisibility:function(){1==o(this.elem).find(this.option.area_var).length&&o(this.elem).find(this.option.area_del).hide()},_ehAddBtn:function(){this._addNewArea(),o(this.elem).find(this.option.area_del).show(),0<this.option.maximum&&o(this.elem).find(this.option.area_var).length>=this.option.maximum&&o(this.option.btn_add).hide(),"function"==typeof this.option.after_add&&this.option.after_add()},_addNewArea:function(){var t=o(this.elem).find(this.option.area_var).length,e=o(this.option.original).clone(!0);this._renumberFieldEach(t,e);var i=this;o(e).find("[name]").each(function(){i._initFieldVal.call(i,this)}).end().appendTo(this.elem)},_initFieldVal:function(t){return"false"!=o(t).attr("empty_val")&&"false"!=o(t).attr("data-empty-val")&&("checkbox"==o(t).attr("type")||"radio"==o(t).attr("type")?t.checked=!1:"SELECT"!=o(t).prop("tagName")&&"submit"!=o(t).attr("type")&&"reset"!=o(t).attr("type")&&"image"!=o(t).attr("type")&&"button"!=o(t).attr("type")&&o(t).val(""),!0)},_ehDelBtn:function(t){t.preventDefault();var e=o(this.elem).find(this.option.btn_del).index(t.target);o(this.elem).find(this.option.area_var).eq(e).remove(),this._setDelBtnVisibility(),this._renumberFieldAll(),0<this.option.maximum&&o(this.elem).find(this.option.area_var).length<this.option.maximum&&o(this.option.btn_add).show()},_renumberFieldAll:function(){var i=this;o(this.elem).find(this.option.area_var).each(function(t,e){i._renumberFieldEach.call(i,t,e)})},_renumberFieldEach:function(t,e){var i=this;o(e).find("[name]").each(function(){o(this).attr("name",i._getValOfAttr(this,t,"name")),o(this).attr("id",i._getValOfAttr(this,t,"id"))}).end().find("[for]").each(function(){o(this).attr("for",i._getValOfAttr(this,t,"for"))})},_getValOfAttr:function(t,e,i){var n,a=!1;/^.+_\d+$/.test(o(t).attr(i))?a=o(t).attr(i).replace(/^(.+_)\d+$/,"$1"+e):(n="name"==i?o(t).attr("name_format")||o(t).attr("data-name-format"):o(t).attr("id_format")||o(t).attr("data-id-format"))&&(a=n.replace("%d",e));return a}})});